
type PoolCreated @entity(immutable: true) {
  id: Bytes!
  poolId: BigInt! # uint256
  deployer: Bytes! # address
  root: Bytes! # address
  LenderDeployer: Bytes! # address
  borrowerDeployer: Bytes! # address
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

type PoolDeployed @entity(immutable: true) {
  id: Bytes!
  poolId: BigInt! # uint256
  seniorRate: BigInt! # uint256
  interestRate: BigInt! # uint256
  periodLength: BigInt! # uint256
  periodCount: BigInt! # uint256
  gracePeriod: BigInt! # uint256
  operator: Bytes! # address
  shelf: Bytes! # address
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}


type Supply @entity(immutable: true) {
  id: Bytes!
  poolId: BigInt! # uint256
  supplier: Bytes! # address
  currencyAmount: BigInt!
  totalPoolBalance: BigInt!
  juniorPoolBalance: BigInt!
  seniorPoolBalance: BigInt!
  blockNumber: BigInt!
  blockTimestamp: BigInt!
}

type Redeem @entity(immutable: true) {
  id: Bytes!
  poolId: BigInt! # uint256
  tranche: String!
  receiver: Bytes! # address
  tokenAmount: BigInt!
  currencyAmount: BigInt!
  totalPoolBalance: BigInt!
  juniorPoolBalance: BigInt!
  seniorPoolBalance: BigInt!
  blockNumber: BigInt!
  blockTimestamp: BigInt!
}

enum PoolStatus {
  CAPITAL_FORMATION,
  PENDING,
  ACTIVE,
  ENDED
}
# main Schema
type Pool @entity(immutable: false) {
  id: Bytes!
  poolId: BigInt! # uint256
  poolStatus: PoolStatus! # enum
  operator: Bytes! # address
  shelf: Bytes! # address
  juniorTranche: Tranche! # Tranche
  seniorRate: BigInt! # uint256
  seniorTranche: Tranche! # Tranche
  interestRate: BigInt! # uint256
  periodLength: BigInt! # uint256
  periodCount: BigInt! # uint256
  loanTerm: BigInt! # uint256
  gracePeriod: BigInt! # uint256
  totalBalance: BigInt! # uint256
  startTimestamp: BigInt! # uint256
  loanMaturityTimestamp: BigInt! # uint256
  totalRepaid: BigInt! # uint256
  principalRepaid: BigInt! # uint256
  interestRepaid: BigInt! # uint256
  capitalFormationPeriod: BigInt! # uint256
  capitalFormationPeriodEnd: BigInt! # uint256
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

type Tranche @entity(immutable: false) {
  id: Bytes!
  poolId: BigInt! # uint256
  trancheType: String!
  trancheAddress: Bytes!
  tokenAddress: Bytes! # address
  totalBalance: BigInt!
  totalTokenSupply: BigInt!
  tokenPrice: BigInt!
  blockTimestamp: BigInt!
}

type Lender @entity(immutable: false) {
  id: Bytes!
  address: Bytes!
  pools: [BigInt!]!
  currencyAmount: BigInt!
  totalPoolBalance: BigInt!
  juniorPoolBalance: BigInt!
  seniorPoolBalance: BigInt!
  blockTimestamp: BigInt!
}